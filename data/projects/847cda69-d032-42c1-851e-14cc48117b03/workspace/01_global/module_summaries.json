[
  {
    "module_name": "账户系统",
    "purpose": "负责为天财业务开立和标记专用的天财收款账户，并控制其专属能力，提供账户的创建、状态管理等底层服务。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/v1/accounts",
        "description": "创建天财专用账户"
      },
      {
        "method": "GET",
        "path": "/v1/accounts/{accountId}",
        "description": "查询账户详情"
      },
      {
        "method": "PATCH",
        "path": "/v1/accounts/{accountId}/status",
        "description": "更新账户状态"
      }
    ],
    "database_tables": [
      {
        "name": "tiancai_accounts",
        "description": "账户系统的核心存储表，存储账户信息"
      }
    ],
    "dependencies": [
      "三代系统",
      "行业钱包系统"
    ],
    "key_features": [
      "账户创建与幂等校验",
      "账户状态管理",
      "账户能力标记",
      "发布账户创建事件"
    ]
  },
  {
    "module_name": "认证系统",
    "purpose": "为电子签约平台等上游系统提供打款验证和人脸验证接口，以支持关系绑定流程的身份认证环节。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/payment-verification/initiate",
        "description": "发起打款验证"
      },
      {
        "method": "POST",
        "path": "/api/v1/payment-verification/confirm",
        "description": "确认（回填）打款验证"
      },
      {
        "method": "POST",
        "path": "/api/v1/face-verification",
        "description": "发起人脸验证"
      },
      {
        "method": "GET",
        "path": "/api/v1/verifications/{id}",
        "description": "查询验证请求状态"
      }
    ],
    "database_tables": [
      {
        "name": "verification_requests",
        "description": "验证请求主表"
      },
      {
        "name": "payment_attempts",
        "description": "打款验证详情表"
      }
    ],
    "dependencies": [
      "电子签约平台",
      "银行通道服务",
      "第三方人脸识别服务"
    ],
    "key_features": [
      "打款验证流程",
      "人脸验证流程",
      "验证状态与生命周期管理",
      "安全与审计"
    ]
  },
  {
    "module_name": "清结算系统",
    "purpose": "负责处理天财分账业务的结算配置、退货账户查询、专用账户冻结及计费信息同步，确保资金流转的正确性与合规性。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/settlement/config",
        "description": "创建或更新结算配置"
      },
      {
        "method": "GET",
        "path": "/api/v1/account/refund/{accountId}",
        "description": "查询用于退货/退款的天财专用账户信息"
      },
      {
        "method": "POST",
        "path": "/api/v1/account/freeze",
        "description": "对天财专用账户执行冻结或解冻操作"
      },
      {
        "method": "POST",
        "path": "/api/v1/billing/sync",
        "description": "同步单笔交易的计费信息"
      }
    ],
    "database_tables": [
      {
        "name": "settlement_config",
        "description": "结算配置表"
      },
      {
        "name": "account_freeze_record",
        "description": "账户冻结操作记录表"
      },
      {
        "name": "billing_sync_log",
        "description": "计费信息同步日志表"
      }
    ],
    "dependencies": [
      "三代系统",
      "业务核心系统",
      "账户系统",
      "计费中台"
    ],
    "key_features": [
      "结算配置处理",
      "退货账户查询",
      "专用账户冻结",
      "计费信息同步",
      "交易触发结算"
    ]
  },
  {
    "module_name": "计费中台",
    "purpose": "为系统内其他业务模块提供中心化的转账计费能力。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/fee/calculate",
        "description": "计算手续费。"
      }
    ],
    "database_tables": [
      {
        "name": "fee_rule",
        "description": "存储不同业务场景和模式下的费率配置。"
      },
      {
        "name": "fee_transaction_log",
        "description": "记录每次计费请求和结果，用于对账和审计。"
      }
    ],
    "dependencies": [
      "行业钱包系统",
      "三代系统",
      "清结算系统"
    ],
    "key_features": [
      "接收计费请求，根据业务规则计算转账手续费",
      "返回计费结果并记录日志"
    ]
  },
  {
    "module_name": "业务核心系统",
    "purpose": "接收并处理天财分账交易记录，进行业务校验、状态管理与数据持久化，并为下游系统提供数据。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/tiancai/split-record",
        "description": "接收行业钱包系统推送的分账交易记录。"
      }
    ],
    "database_tables": [
      {
        "name": "tiancai_split_record",
        "description": "天财分账交易记录表"
      }
    ],
    "dependencies": [
      "行业钱包系统",
      "计费中台",
      "清结算系统",
      "对账单系统"
    ],
    "key_features": [
      "分账交易记录接收与校验",
      "业务状态管理（幂等、状态流转）",
      "触发下游计费与结算流程",
      "发布交易处理完成事件"
    ]
  },
  {
    "module_name": "钱包APP/商服平台",
    "purpose": "为商户提供天财分账业务相关的操作界面与前端逻辑，例如查看账户信息、发起或管理归集/批量付款/会员结算流程、处理关系绑定与开通付款的授权签约、查询账单等。",
    "interfaces": [],
    "database_tables": [],
    "dependencies": [
      "电子签约平台",
      "行业钱包系统",
      "三代系统",
      "对账单系统",
      "钱包APP"
    ],
    "key_features": [
      "关系绑定流程",
      "开通付款流程",
      "归集发起",
      "批量付款发起",
      "会员结算发起",
      "账单查询"
    ]
  },
  {
    "module_name": "三代系统",
    "purpose": "天财分账业务的核心管理平台，负责商户管理、调用账户系统接口为商户开立天财专用账户、配置结算账户与手续费，并对天财机构进行标识。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/v1/merchants/tiancai-config",
        "description": "为商户配置天财业务并请求开户。"
      },
      {
        "method": "GET",
        "path": "/v1/merchants/{merchantId}/tiancai-config",
        "description": "查询商户的天财业务配置信息。"
      },
      {
        "method": "PATCH",
        "path": "/v1/merchants/{merchantId}/settlement-config",
        "description": "更新商户的结算账户与手续费配置。"
      }
    ],
    "database_tables": [
      {
        "name": "tiancai_merchant_configs",
        "description": "存储商户的天财业务配置信息，包括账户ID、结算配置、状态等。"
      }
    ],
    "dependencies": [
      "账户系统"
    ],
    "key_features": [
      "商户入驻与天财机构标识",
      "发起并处理天财专用账户开户",
      "配置结算账户与手续费",
      "通过事件与下游系统同步配置信息"
    ]
  },
  {
    "module_name": "电子签约平台",
    "purpose": "为天财分账业务提供签约与认证流程编排的中心化服务，管理协议模板、封装H5页面、推送签约短信，并作为流程中枢调用认证系统完成验证，最终将结果同步至行业钱包系统以完成关系绑定。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/sign/initiate",
        "description": "上游系统（行业钱包系统/三代系统）发起签约流程"
      },
      {
        "method": "GET",
        "path": "/api/v1/sign/status/{signRequestId}",
        "description": "查询签约流程状态"
      },
      {
        "method": "POST",
        "path": "/api/v1/sign/callback/payment",
        "description": "接收认证系统打款验证结果回调"
      },
      {
        "method": "POST",
        "path": "/api/v1/sign/callback/face",
        "description": "接收认证系统人脸验证结果回调"
      }
    ],
    "database_tables": [
      {
        "name": "sign_requests",
        "description": "签约请求主表"
      },
      {
        "name": "sign_records",
        "description": "签约记录表"
      },
      {
        "name": "auth_attempts",
        "description": "认证尝试记录表"
      }
    ],
    "dependencies": [
      "行业钱包系统",
      "三代系统",
      "认证系统",
      "短信服务",
      "协议模板存储服务"
    ],
    "key_features": [
      "签约流程编排与H5页面生成",
      "基于业务场景的认证方法决策与集成",
      "认证结果处理与状态同步"
    ]
  },
  {
    "module_name": "行业钱包系统",
    "purpose": "负责处理天财专用账户开户后的业务逻辑，包括关系绑定、分账处理及与清结算等系统的协同。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/v1/relationship/bind",
        "description": "发起关系绑定（签约与认证）"
      },
      {
        "method": "GET",
        "path": "/v1/relationship/{relationshipId}",
        "description": "查询关系绑定状态"
      },
      {
        "method": "POST",
        "path": "/v1/ledger/split",
        "description": "发起分账（归集、会员结算、批量付款）"
      },
      {
        "method": "GET",
        "path": "/v1/ledger/records/{recordId}",
        "description": "查询分账记录详情"
      }
    ],
    "database_tables": [
      {
        "name": "tiancai_business_relationships",
        "description": "关系绑定表"
      },
      {
        "name": "tiancai_ledger_records",
        "description": "分账记录表"
      }
    ],
    "dependencies": [
      "账户系统",
      "三代系统",
      "电子签约平台",
      "认证系统",
      "计费中台",
      "清结算系统",
      "业务核心系统",
      "对账单系统"
    ],
    "key_features": [
      "接收并校验商户配置信息",
      "管理收付双方的关系绑定",
      "处理分账请求",
      "与清结算、计费中台等系统协同完成资金处理"
    ]
  },
  {
    "module_name": "对账单系统",
    "purpose": "聚合上游交易与结算数据，按机构、时间等维度进行汇总与核对，生成并提供标准格式的对账单文件或查询接口。",
    "interfaces": [
      {
        "method": "GET",
        "path": "/api/v1/statements",
        "description": "查询对账单列表"
      },
      {
        "method": "GET",
        "path": "/api/v1/statements/{statementId}/download",
        "description": "下载指定对账单文件"
      },
      {
        "method": "POST",
        "path": "/api/v1/statements/generate",
        "description": "触发对账单生成（如按日/月批量生成）"
      }
    ],
    "database_tables": [
      {
        "name": "tiancai_statements",
        "description": "对账单主表"
      },
      {
        "name": "tiancai_statement_items",
        "description": "对账单明细表"
      }
    ],
    "dependencies": [
      "业务核心系统",
      "清结算系统"
    ],
    "key_features": [
      "消费上游事件进行数据收集",
      "定时或手动触发账单生成",
      "数据聚合与核对",
      "生成标准格式账单文件",
      "提供账单查询与下载接口"
    ]
  }
]