[
  {
    "module_name": "账户系统",
    "purpose": "负责为天财分账业务开立并标记天财专用账户，控制账户的支付、收款、冻结等核心能力，并支持账户的升级操作。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/accounts",
        "description": "创建天财专用账户"
      },
      {
        "method": "PUT",
        "path": "/api/v1/accounts/{accountId}/status",
        "description": "变更账户状态（如冻结、解冻）"
      },
      {
        "method": "PUT",
        "path": "/api/v1/accounts/{accountId}/abilities",
        "description": "控制账户能力（如支付、收款开关）"
      },
      {
        "method": "GET",
        "path": "/api/v1/accounts/{accountId}",
        "description": "查询账户详情"
      }
    ],
    "database_tables": [
      {
        "name": "accounts",
        "description": "账户主表"
      },
      {
        "name": "account_abilities",
        "description": "账户能力关联表"
      },
      {
        "name": "account_status_logs",
        "description": "账户状态变更日志表"
      }
    ],
    "dependencies": [
      "三代系统",
      "行业钱包系统",
      "清结算系统"
    ],
    "key_features": [
      "账户创建与标记",
      "账户状态管理（冻结/解冻）",
      "账户能力控制（支付/收款开关）",
      "账户标记升级"
    ]
  },
  {
    "module_name": "计费中台",
    "purpose": "为系统内其他业务模块提供统一、准确的转账手续费计算能力",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/fee/calculate",
        "description": "计算单笔转账手续费"
      }
    ],
    "database_tables": [
      {
        "name": "fee_rule",
        "description": "存储不同业务场景下的计费规则"
      },
      {
        "name": "fee_calculation_log",
        "description": "记录每次手续费计算请求与结果，用于对账、审计和幂等"
      }
    ],
    "dependencies": [
      "行业钱包系统"
    ],
    "key_features": [
      "提供手续费计算API",
      "支持多业务场景计费规则",
      "内置幂等性控制",
      "支持手续费承担方配置"
    ]
  },
  {
    "module_name": "清结算系统",
    "purpose": "处理与账户状态和资金结算相关的核心操作，包括结算账户配置、退货终点账户查询、专用账户冻结与解冻。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/settlement/config",
        "description": "接收结算账户配置"
      },
      {
        "method": "GET",
        "path": "/api/v1/settlement/account/query",
        "description": "查询退货终点账户信息"
      },
      {
        "method": "POST",
        "path": "/api/v1/account/freeze",
        "description": "执行专用账户冻结操作"
      },
      {
        "method": "POST",
        "path": "/api/v1/account/unfreeze",
        "description": "执行专用账户解冻操作"
      }
    ],
    "database_tables": [
      {
        "name": "settlement_account_config",
        "description": "结算账户配置表"
      },
      {
        "name": "account_freeze_record",
        "description": "账户冻结记录表"
      }
    ],
    "dependencies": [
      "账户系统",
      "三代系统",
      "业务核心",
      "对账单系统"
    ],
    "key_features": [
      "结算账户配置与验证",
      "退货终点账户查询",
      "专用账户冻结与解冻操作"
    ]
  },
  {
    "module_name": "认证系统",
    "purpose": "为天财分账业务中的关系绑定、开通付款等流程提供身份与授权认证能力，处理由电子签章系统发起的打款验证和人脸验证，并返回认证结果。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/verification/payment",
        "description": "发起打款验证"
      },
      {
        "method": "POST",
        "path": "/api/v1/verification/face",
        "description": "发起人脸验证"
      },
      {
        "method": "GET",
        "path": "/api/v1/verification/records/{requestId}",
        "description": "查询认证记录状态"
      }
    ],
    "database_tables": [
      {
        "name": "authentication_request",
        "description": "认证请求主表"
      },
      {
        "name": "verification_record",
        "description": "验证过程与结果明细表"
      }
    ],
    "dependencies": [
      "电子签章系统"
    ],
    "key_features": [
      "处理打款验证",
      "处理人脸验证",
      "提供认证结果查询"
    ]
  },
  {
    "module_name": "钱包app/商服平台",
    "purpose": "面向商户的前端单页应用，提供天财分账业务的交互界面，负责用户交互、数据收集与展示，以及向后端服务发起请求。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/account/guide",
        "description": "获取账户开通引导信息"
      },
      {
        "method": "POST",
        "path": "/api/v1/binding/initiate",
        "description": "发起关系绑定请求"
      },
      {
        "method": "GET",
        "path": "/api/v1/binding/status/{bindingId}",
        "description": "查询关系绑定状态"
      },
      {
        "method": "POST",
        "path": "/api/v1/instruction/collect",
        "description": "发起归集指令"
      },
      {
        "method": "POST",
        "path": "/api/v1/instruction/batch-payment",
        "description": "发起批量付款指令"
      },
      {
        "method": "POST",
        "path": "/api/v1/instruction/member-settlement",
        "description": "发起会员结算指令"
      },
      {
        "method": "GET",
        "path": "/api/v1/instruction/{instructionId}/result",
        "description": "查询指令执行结果"
      },
      {
        "method": "GET",
        "path": "/api/v1/bill/query",
        "description": "查询账单"
      },
      {
        "method": "POST",
        "path": "/api/v1/payment/activate",
        "description": "发起开通付款流程"
      }
    ],
    "database_tables": [],
    "dependencies": [
      "行业钱包系统",
      "三代系统",
      "电子签章系统",
      "对账单系统"
    ],
    "key_features": [
      "账户开通引导",
      "关系绑定流程管理",
      "分账指令发起与状态跟踪",
      "开通付款流程引导",
      "前端状态与草稿管理"
    ]
  },
  {
    "module_name": "电子签章系统",
    "purpose": "为天财分账业务中的关系绑定、开通付款等流程提供电子协议签署与认证发起能力。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/agreement/initiate",
        "description": "接收上游系统发起的签约请求，启动签约流程。"
      },
      {
        "method": "GET",
        "path": "/api/v1/agreement/{agreementId}",
        "description": "根据协议ID查询协议详情及签署状态。"
      },
      {
        "method": "POST",
        "path": "/api/v1/agreement/callback/sign",
        "description": "接收H5页面签署完成后的回调。"
      },
      {
        "method": "GET",
        "path": "/api/v1/template/agreement/{templateId}",
        "description": "查询协议模板详情。"
      },
      {
        "method": "POST",
        "path": "/api/v1/template/agreement",
        "description": "创建或更新协议模板。"
      }
    ],
    "database_tables": [
      {
        "name": "agreement_template",
        "description": "存储可配置的电子协议模板。"
      },
      {
        "name": "sms_template",
        "description": "存储与协议模板配套的短信通知模板。"
      },
      {
        "name": "agreement_instance",
        "description": "存储每次签约流程生成的协议实例。"
      },
      {
        "name": "signing_record",
        "description": "存储用户签署行为记录。"
      }
    ],
    "dependencies": [
      "认证系统"
    ],
    "key_features": [
      "协议模板配置与管理",
      "发起签约与认证",
      "协议生成与变量替换",
      "通知与签署引导",
      "签署完成与存储",
      "协议生命周期管理"
    ]
  },
  {
    "module_name": "行业钱包系统",
    "purpose": "负责天财专用账户的开户校验、角色管理、分账关系绑定校验、分账请求处理及数据同步。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/account/open",
        "description": "接收三代系统的开户请求，进行校验并调用账户系统。"
      },
      {
        "method": "POST",
        "path": "/api/v1/relationship/bind",
        "description": "发起关系绑定流程，调用电子签章系统。"
      },
      {
        "method": "POST",
        "path": "/api/v1/transfer",
        "description": "处理分账请求（归集、批量付款、会员结算）。"
      },
      {
        "method": "GET",
        "path": "/api/v1/account/{accountId}/status",
        "description": "查询账户状态及绑定关系。"
      }
    ],
    "database_tables": [
      {
        "name": "tiancai_accounts",
        "description": "天财专用账户信息表。"
      },
      {
        "name": "account_roles",
        "description": "账户角色关联表（总部、门店）。"
      },
      {
        "name": "relationship_bindings",
        "description": "分账关系绑定表。"
      },
      {
        "name": "transfer_records",
        "description": "分账交易记录表。"
      }
    ],
    "dependencies": [
      "三代系统",
      "账户系统",
      "电子签章系统",
      "计费中台",
      "清结算系统",
      "业务核心"
    ],
    "key_features": [
      "天财专用账户开户流程",
      "分账关系绑定流程",
      "分账处理流程（归集/批量付款/会员结算）",
      "账户与关系状态同步流程"
    ]
  },
  {
    "module_name": "三代系统",
    "purpose": "天财分账业务的关键上游系统，负责商户和账户的初始化与配置，包括开通天财专用账户、配置结算模式、发起分账关系绑定。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/tiancai/account/open",
        "description": "发起天财专用账户开户请求"
      },
      {
        "method": "POST",
        "path": "/api/v1/tiancai/settlement/config",
        "description": "配置商户的结算账户模式"
      },
      {
        "method": "POST",
        "path": "/api/v1/tiancai/relationship/bind",
        "description": "发起分账关系绑定（签约与认证）"
      },
      {
        "method": "GET",
        "path": "/api/v1/tiancai/merchant/{merchantId}/status",
        "description": "查询商户的天财分账业务开通状态"
      },
      {
        "method": "POST",
        "path": "/api/v1/tiancai/callback/wallet",
        "description": "接收行业钱包系统的异步回调（用于开户、关系绑定状态更新）"
      }
    ],
    "database_tables": [
      {
        "name": "tiancai_merchant_config",
        "description": "商户天财分账配置表"
      },
      {
        "name": "tiancai_account_mapping",
        "description": "三代商户与天财账户映射表"
      },
      {
        "name": "settlement_config_log",
        "description": "结算账户配置记录表"
      },
      {
        "name": "relationship_binding_log",
        "description": "分账关系绑定记录表"
      }
    ],
    "dependencies": [
      "行业钱包系统",
      "清结算系统"
    ],
    "key_features": [
      "校验机构号并开通天财专用账户",
      "配置商户结算账户模式（仅支持主动结算）",
      "发起并管理分账关系绑定流程"
    ]
  },
  {
    "module_name": "业务核心",
    "purpose": "接收并处理天财分账交易请求，作为资金划转的入口，协调完成后续资金处理流程。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/transfer/execute",
        "description": "接收行业钱包系统的分账（资金划转）请求。"
      }
    ],
    "database_tables": [
      {
        "name": "transfer_execution_records",
        "description": "交易执行记录表。"
      }
    ],
    "dependencies": [
      "行业钱包系统",
      "支付系统",
      "清结算系统"
    ],
    "key_features": [
      "接收并校验分账交易请求",
      "根据路由规则选择底层支付或清结算通道",
      "调用底层通道执行资金划转并传递手续费指令",
      "处理请求幂等性与通道调用失败重试"
    ]
  },
  {
    "module_name": "对账单系统",
    "purpose": "为天财分账业务生成机构层级的各类账单，包括分账、提款、收单、结算账单。",
    "interfaces": [
      {
        "method": "GET",
        "path": "/api/v1/statement/tiancai/transfer",
        "description": "查询天财分账账单"
      },
      {
        "method": "GET",
        "path": "/api/v1/statement/withdrawal",
        "description": "查询提款账单"
      },
      {
        "method": "GET",
        "path": "/api/v1/statement/acquiring",
        "description": "查询收单账单"
      },
      {
        "method": "GET",
        "path": "/api/v1/statement/settlement",
        "description": "查询结算账单"
      },
      {
        "method": "POST",
        "path": "/api/v1/statement/generate",
        "description": "触发账单生成任务"
      }
    ],
    "database_tables": [
      {
        "name": "statement_tiancai_transfer",
        "description": "天财分账账单明细表"
      },
      {
        "name": "statement_withdrawal",
        "description": "提款账单明细表"
      },
      {
        "name": "statement_acquiring",
        "description": "收单账单明细表"
      },
      {
        "name": "statement_settlement",
        "description": "结算账单明细表"
      },
      {
        "name": "statement_summary",
        "description": "账单汇总表"
      }
    ],
    "dependencies": [
      "业务核心",
      "清结算系统",
      "行业钱包系统"
    ],
    "key_features": [
      "监听业务事件生成账单明细",
      "提供多维度账单查询接口",
      "支持账单数据汇总与补单"
    ]
  }
]