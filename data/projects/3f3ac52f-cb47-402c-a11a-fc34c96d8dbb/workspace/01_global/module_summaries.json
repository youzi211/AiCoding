[
  {
    "module_name": "账户系统",
    "purpose": "为‘天财’业务场景下的实体提供底层账户的创建、管理和资金操作服务，是资金流转的基石。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/accounts",
        "description": "为指定商户开立新的天财专用账户"
      },
      {
        "method": "POST",
        "path": "/api/v1/accounts/{accountNo}/upgrade-to-tiancai",
        "description": "将已有账户升级标记为天财专用账户"
      },
      {
        "method": "POST",
        "path": "/api/v1/accounts/{accountNo}/status",
        "description": "冻结、解冻或注销账户"
      },
      {
        "method": "POST",
        "path": "/api/v1/accounts/transactions",
        "description": "执行原子化的资金操作（入账、出账、冻结、解冻），为内部接口"
      },
      {
        "method": "GET",
        "path": "/api/v1/accounts/{accountNo}",
        "description": "查询账户信息"
      },
      {
        "method": "GET",
        "path": "/api/v1/accounts/{accountNo}/balance",
        "description": "查询账户余额"
      },
      {
        "method": "GET",
        "path": "/api/v1/accounts/{accountNo}/transactions",
        "description": "查询交易流水"
      }
    ],
    "database_tables": [
      {
        "name": "t_account",
        "description": "账户主表，存储账户核心信息"
      },
      {
        "name": "t_account_transaction",
        "description": "账户流水表，用于记录所有资金变动，支持对账与审计"
      }
    ],
    "dependencies": [
      "行业钱包系统",
      "清结算系统",
      "三代系统",
      "对账单系统"
    ],
    "key_features": [
      "账户生命周期管理",
      "原子化账务处理与强一致性保证",
      "内部账户管理",
      "通过事件发布通知下游系统"
    ]
  },
  {
    "module_name": "认证系统",
    "purpose": "负责管理商户间资金流转前的身份认证、协议签署及绑定关系生命周期，确保资金流转的合法性与安全性。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/auth/bindings",
        "description": "发起关系绑定流程，创建认证流程实例。"
      },
      {
        "method": "GET",
        "path": "/api/v1/auth/bindings/{bindingId}",
        "description": "查询指定绑定关系的详细信息与状态。"
      },
      {
        "method": "POST",
        "path": "/api/v1/auth/bindings/{bindingId}/enable-payment",
        "description": "在已有绑定关系基础上，为批量付款或会员结算场景触发“开通付款”流程。"
      },
      {
        "method": "POST",
        "path": "/api/v1/auth/callbacks/{authFlowId}",
        "description": "接收来自电子签约或支付系统的异步回调，更新认证状态。"
      },
      {
        "method": "POST",
        "path": "/api/v1/auth/verifications/remit",
        "description": "请求支付系统向指定对公账户发起小额打款以进行验证。"
      },
      {
        "method": "POST",
        "path": "/api/v1/auth/verifications/remit/{verificationId}/confirm",
        "description": "提交用户回填的打款金额，完成打款验证。"
      }
    ],
    "database_tables": [
      {
        "name": "auth_binding_relationship",
        "description": "存储绑定关系的核心信息与生命周期状态。"
      },
      {
        "name": "auth_flow",
        "description": "存储每一次认证流程的详细步骤与状态。"
      },
      {
        "name": "auth_audit_log",
        "description": "存储所有关键操作日志，用于审计。"
      }
    ],
    "dependencies": [
      "三代系统",
      "行业钱包系统",
      "电子签约平台",
      "支付系统/清结算系统",
      "账户系统",
      "业务核心"
    ],
    "key_features": [
      "支持打款验证与人脸验证两种认证方式",
      "集成电子签约完成协议在线签署",
      "管理绑定关系的全生命周期状态机",
      "为分账等业务提供前置的合法性校验"
    ]
  },
  {
    "module_name": "计费中台",
    "purpose": "作为核心计费引擎，根据预设规则计算资金流转过程中的手续费，并确定承担方。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/fee/calculate",
        "description": "核心计费接口，根据交易信息计算手续费。"
      },
      {
        "method": "GET",
        "path": "/api/v1/fee/result/{feeRequestId}",
        "description": "根据计费请求ID查询详细的计费结果。"
      }
    ],
    "database_tables": [
      {
        "name": "fee_rule",
        "description": "存储所有计费规则。"
      },
      {
        "name": "fee_request",
        "description": "记录每一次计费请求和结果。"
      },
      {
        "name": "fee_detail",
        "description": "记录每笔手续费的计算明细。"
      }
    ],
    "dependencies": [
      "业务核心",
      "清结算系统",
      "对账单系统"
    ],
    "key_features": [
      "统一计费规则管理",
      "多维度规则匹配与费用计算",
      "计费结果记录与事件发布"
    ]
  },
  {
    "module_name": "三代系统",
    "purpose": "作为商户、机构、账户和业务关系的权威数据源和业务控制中心，负责业务校验与控制。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/merchants",
        "description": "创建/注册商户"
      },
      {
        "method": "POST",
        "path": "/api/v1/merchants/{merchantId}/accounts/apply",
        "description": "申请开通天财专用账户"
      },
      {
        "method": "POST",
        "path": "/api/v1/business-relationships",
        "description": "创建业务关系"
      },
      {
        "method": "POST",
        "path": "/api/v1/business-relationships/validate",
        "description": "核心内部接口，业务关系校验"
      },
      {
        "method": "POST",
        "path": "/tiancai/api/v1/split",
        "description": "供天财商龙调用，发起分账等资金流转请求"
      }
    ],
    "database_tables": [
      {
        "name": "t_merchant",
        "description": "商户信息表（权威数据源）"
      },
      {
        "name": "t_account_binding",
        "description": "商户-账户绑定关系表"
      },
      {
        "name": "t_account_apply",
        "description": "账户开通申请记录表"
      },
      {
        "name": "t_business_relationship",
        "description": "业务关系授权表"
      },
      {
        "name": "t_business_request",
        "description": "业务请求记录表"
      }
    ],
    "dependencies": [
      "行业钱包系统",
      "账户系统",
      "电子签约平台"
    ],
    "key_features": [
      "商户与机构管理",
      "业务关系与授权管理",
      "账户开通控制",
      "业务规则校验"
    ]
  },
  {
    "module_name": "业务核心",
    "purpose": "作为“天财分账”业务的核心交易处理引擎，负责处理分账、归集、批量付款等资金流转指令，并确保交易最终一致性。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/transactions/split",
        "description": "执行分账/转账"
      },
      {
        "method": "POST",
        "path": "/api/v1/transactions/batch-payment",
        "description": "发起批量付款（异步）"
      },
      {
        "method": "GET",
        "path": "/api/v1/transactions/{transactionNo}",
        "description": "查询交易详情"
      },
      {
        "method": "GET",
        "path": "/api/v1/transactions/batches/{batchNo}",
        "description": "查询批量任务详情"
      },
      {
        "method": "POST",
        "path": "/api/v1/transactions/{transactionNo}/reverse",
        "description": "交易冲正"
      }
    ],
    "database_tables": [
      {
        "name": "t_transaction",
        "description": "交易主表"
      },
      {
        "name": "t_batch_task",
        "description": "批量任务表"
      },
      {
        "name": "t_batch_task_item",
        "description": "批量任务明细表"
      },
      {
        "name": "t_relation_cache",
        "description": "关系绑定缓存表"
      }
    ],
    "dependencies": [
      "行业钱包系统",
      "账户系统",
      "计费中台",
      "电子签约平台",
      "对账单系统"
    ],
    "key_features": [
      "交易指令处理与业务规则校验",
      "手续费计算与交易编排",
      "异步批量任务处理",
      "交易状态管理与冲正",
      "基于事件的关系绑定缓存管理"
    ]
  },
  {
    "module_name": "清结算系统",
    "purpose": "负责处理收单资金的清算（资金计算与核对）与结算（资金划拨）全流程，确保商户资金按时、准确、安全地入账。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/settlements/instructions",
        "description": "创建结算指令，触发单笔或批量资金的结算"
      },
      {
        "method": "POST",
        "path": "/api/v1/settlements/{instructionNo}/retry",
        "description": "对失败的结算指令进行手动或自动重试"
      },
      {
        "method": "GET",
        "path": "/api/v1/settlements/instructions/{instructionNo}",
        "description": "查询结算指令详情"
      },
      {
        "method": "GET",
        "path": "/api/v1/settlements/merchants/{merchantId}",
        "description": "查询商户结算记录"
      },
      {
        "method": "GET",
        "path": "/api/v1/settlements/daily-summary",
        "description": "查询日终结算汇总"
      },
      {
        "method": "POST",
        "path": "/api/v1/settlements/daily-closing",
        "description": "手动触发T+1结算的日终批处理流程"
      }
    ],
    "database_tables": [
      {
        "name": "t_settlement_instruction",
        "description": "结算指令主表"
      },
      {
        "name": "t_settlement_detail",
        "description": "结算明细表（关联原始交易）"
      },
      {
        "name": "t_daily_settlement_batch",
        "description": "日终结算批次表"
      }
    ],
    "dependencies": [
      "账户系统",
      "业务核心/支付系统",
      "计费中台",
      "对账单系统",
      "三代系统"
    ],
    "key_features": [
      "结算处理（主动/被动模式）",
      "退货资金处理",
      "日终批处理",
      "异常处理与对账"
    ]
  },
  {
    "module_name": "电子签章系统",
    "purpose": "为‘天财分账’业务提供安全、合规、可追溯的电子协议签署服务，支撑协议签署与身份认证流程。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/sign/tasks",
        "description": "认证系统调用，创建签署任务"
      },
      {
        "method": "GET",
        "path": "/api/v1/sign/tasks/{signTaskId}",
        "description": "查询签署任务状态"
      },
      {
        "method": "POST",
        "path": "/api/v1/sign/callbacks/{signTaskId}",
        "description": "接收H5页面或CA机构的签署结果回调"
      },
      {
        "method": "GET",
        "path": "/api/v1/sign/agreements/preview",
        "description": "H5页面调用，获取协议预览内容"
      },
      {
        "method": "GET",
        "path": "/api/v1/sign/agreements/{agreementId}",
        "description": "供业务系统下载或验证已签署协议"
      },
      {
        "method": "POST",
        "path": "/api/v1/template",
        "description": "内部管理接口，创建或更新协议模板"
      },
      {
        "method": "GET",
        "path": "/api/v1/template",
        "description": "查询协议模板列表或详情"
      }
    ],
    "database_tables": [
      {
        "name": "sign_template",
        "description": "存储协议模板"
      },
      {
        "name": "sign_task",
        "description": "存储签署任务实例"
      },
      {
        "name": "sign_party",
        "description": "存储签署任务的参与方信息及签署状态"
      },
      {
        "name": "sign_audit_log",
        "description": "签署过程审计日志"
      }
    ],
    "dependencies": [
      "认证系统",
      "短信网关",
      "对象存储服务",
      "第三方存证平台",
      "CA机构（可选）"
    ],
    "key_features": [
      "协议模板管理与动态内容生成",
      "H5签署页面封装与短信触发",
      "全证据链存证",
      "与认证系统协同的流程调度"
    ]
  },
  {
    "module_name": "行业钱包系统",
    "purpose": "作为业务系统与底层账户系统之间的桥梁，负责处理天财专用账户的开户、关系绑定认证及核心资金流转操作。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/wallet/accounts/open",
        "description": "开通天财专用账户"
      },
      {
        "method": "GET",
        "path": "/api/v1/wallet/accounts/{accountNo}/relationships",
        "description": "查询账户关联关系"
      },
      {
        "method": "POST",
        "path": "/api/v1/wallet/relationships/initiate-auth",
        "description": "发起关系绑定认证"
      },
      {
        "method": "POST",
        "path": "/api/v1/wallet/transfers/execute",
        "description": "执行资金划转（核心接口）"
      },
      {
        "method": "GET",
        "path": "/api/v1/wallet/transfers/{walletTransactionNo}",
        "description": "查询交易详情"
      }
    ],
    "database_tables": [
      {
        "name": "t_wallet_account",
        "description": "钱包账户信息表（同步账户系统，增加业务属性）"
      },
      {
        "name": "t_account_relationship",
        "description": "账户关系绑定表（业务关系在账户层的映射）"
      },
      {
        "name": "t_wallet_transaction",
        "description": "钱包交易记录表（业务流水）"
      },
      {
        "name": "t_auth_task",
        "description": "身份认证任务表"
      }
    ],
    "dependencies": [
      "三代系统",
      "账户系统",
      "电子签约平台",
      "计费中台",
      "认证服务"
    ],
    "key_features": [
      "账户开通与升级",
      "关系绑定与身份认证",
      "资金流转处理与账户级校验",
      "手续费计算与处理"
    ]
  },
  {
    "module_name": "钱包APP/商服平台",
    "purpose": "作为连接上层业务管理系统与底层核心金融系统的枢纽，负责天财专用账户管理、资金流转指令处理及为商户提供服务平台。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/accounts/open",
        "description": "开通天财专用账户"
      },
      {
        "method": "POST",
        "path": "/api/v1/accounts/{accountNo}/bank-cards",
        "description": "绑定提现银行卡"
      },
      {
        "method": "POST",
        "path": "/api/v1/transfers/tiancai-split",
        "description": "执行天财分账（核心内部接口）"
      },
      {
        "method": "GET",
        "path": "/api/v1/merchant/accounts",
        "description": "查询商户账户概览"
      },
      {
        "method": "POST",
        "path": "/api/v1/merchant/business-relationships/initiate",
        "description": "发起业务关系绑定"
      },
      {
        "method": "GET",
        "path": "/api/v1/merchant/statements",
        "description": "查询对账单"
      }
    ],
    "database_tables": [
      {
        "name": "t_tiancai_account",
        "description": "天财账户信息表"
      },
      {
        "name": "t_bank_card_binding",
        "description": "银行卡绑定表"
      },
      {
        "name": "t_fund_transfer",
        "description": "资金转账记录表"
      },
      {
        "name": "t_relationship_process",
        "description": "业务关系绑定流程记录表"
      }
    ],
    "dependencies": [
      "三代系统",
      "账户系统",
      "电子签约平台",
      "计费中台",
      "对账单系统",
      "清结算系统/业务核心"
    ],
    "key_features": [
      "天财专用账户管理",
      "资金流转指令处理与二次校验",
      "商户服务门户(H5/APP)",
      "业务关系绑定流程驱动",
      "手续费计算与路由"
    ]
  },
  {
    "module_name": "对账单系统",
    "purpose": "聚合各业务系统的资金与交易数据，为不同层级用户生成并提供结构清晰、数据准确、格式多样的对账单。",
    "interfaces": [
      {
        "method": "GET",
        "path": "/api/v1/statements/accounts/{accountNo}/transactions",
        "description": "查询指定账户在特定时间范围内的所有资金变动明细。"
      },
      {
        "method": "GET",
        "path": "/api/v1/statements/merchants/{merchantId}/summary",
        "description": "查询指定商户在特定结算周期内的资金结算汇总情况。"
      },
      {
        "method": "GET",
        "path": "/api/v1/statements/institutions/{institutionId}/daily-summary",
        "description": "供总部或运营查看某机构在特定日期的整体资金流水汇总。"
      },
      {
        "method": "POST",
        "path": "/api/v1/statements/generation/daily",
        "description": "手动触发生成指定日期的各类日终账单。"
      },
      {
        "method": "POST",
        "path": "/api/v1/statements/export",
        "description": "根据复杂查询条件导出账单数据为文件（如Excel），返回文件下载链接。"
      }
    ],
    "database_tables": [
      {
        "name": "t_account_statement_detail",
        "description": "账户动账明细表（最细粒度），记录所有账户的资金变动流水。"
      },
      {
        "name": "t_merchant_settlement_statement",
        "description": "商户结算单表（按结算日聚合），记录商户的结算汇总信息。"
      },
      {
        "name": "t_institution_daily_summary",
        "description": "机构日汇总表（预聚合），存储机构维度的日度汇总数据以提升查询性能。"
      },
      {
        "name": "t_statement_export_task",
        "description": "账单导出任务表，管理异步导出任务的状态和结果。"
      }
    ],
    "dependencies": [
      "账户系统",
      "清结算系统",
      "业务核心",
      "行业钱包系统",
      "文件存储服务"
    ],
    "key_features": [
      "动账明细生成",
      "交易账单生成",
      "机构层级汇总账单生成",
      "账单查询与导出",
      "账单推送与通知"
    ]
  }
]