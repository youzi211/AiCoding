[
  {
    "module_name": "账户系统",
    "purpose": "为支付平台提供底层账户的全生命周期管理、状态控制及资金记账服务，是支撑分账业务流程的基石。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/accounts",
        "description": "创建账户"
      },
      {
        "method": "PUT",
        "path": "/api/v1/accounts/{accountNo}/status",
        "description": "更新账户状态"
      },
      {
        "method": "GET",
        "path": "/api/v1/accounts/{accountNo}",
        "description": "查询账户详情"
      },
      {
        "method": "POST",
        "path": "/api/v1/accounts/batch-query",
        "description": "批量查询账户信息"
      },
      {
        "method": "POST",
        "path": "/api/v1/accounts/transfer",
        "description": "账户间转账（内部调用）"
      },
      {
        "method": "POST",
        "path": "/api/v1/accounts/adjust",
        "description": "账户调账（内部调用）"
      },
      {
        "method": "GET",
        "path": "/api/v1/accounts/{accountNo}/balance",
        "description": "查询账户余额"
      },
      {
        "method": "GET",
        "path": "/api/v1/accounts/{accountNo}/transactions",
        "description": "查询账户流水"
      }
    ],
    "database_tables": [
      {
        "name": "account",
        "description": "账户主表，存储账户核心信息"
      },
      {
        "name": "account_transaction",
        "description": "账户流水表，记录所有资金变动"
      },
      {
        "name": "internal_account",
        "description": "内部账户表，管理如待结算账户等内部账户"
      }
    ],
    "dependencies": [
      "行业钱包系统",
      "清结算系统",
      "三代系统",
      "对账单系统"
    ],
    "key_features": [
      "账户创建与状态管理",
      "资金记账与内部转账",
      "幂等控制与乐观锁",
      "事件发布（如账户创建、余额变动）"
    ]
  },
  {
    "module_name": "电子签约平台",
    "purpose": "为分账关系建立提供合法、合规、可追溯的授权基础，负责电子协议签署、身份认证及证据链留存。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/contract/initiate",
        "description": "行业钱包系统发起签约认证，创建签约任务"
      },
      {
        "method": "GET",
        "path": "/api/v1/contract/task/{signTaskId}",
        "description": "查询签约任务状态"
      },
      {
        "method": "POST",
        "path": "/api/v1/contract/open-payment-auth",
        "description": "为付方（总部）发起代付协议签署"
      },
      {
        "method": "GET",
        "path": "/h5/v1/contract/data",
        "description": "H5页面获取签约数据"
      },
      {
        "method": "POST",
        "path": "/h5/v1/contract/verify-sms",
        "description": "H5页面提交短信验证码"
      },
      {
        "method": "POST",
        "path": "/h5/v1/contract/confirm-sign",
        "description": "H5页面确认签署协议"
      }
    ],
    "database_tables": [
      {
        "name": "t_sign_task",
        "description": "签约任务主表，记录任务核心信息与状态"
      },
      {
        "name": "t_contract_record",
        "description": "协议签署记录表，记录每份协议的签署详情"
      },
      {
        "name": "t_auth_record",
        "description": "身份认证记录表，记录打款/人脸认证过程与结果"
      },
      {
        "name": "t_sms_record",
        "description": "短信验证记录表，管理短信验证码的发送与使用"
      }
    ],
    "dependencies": [
      "行业钱包系统",
      "账户系统",
      "外部认证服务",
      "短信服务平台",
      "文件存储服务"
    ],
    "key_features": [
      "标准化电子协议签署流程",
      "集成打款与人脸双重身份认证",
      "全流程证据链固化与留存",
      "提供H5页面与API供上游集成"
    ]
  },
  {
    "module_name": "认证系统",
    "purpose": "为分账业务的付方与收方建立合法、可信的授权关系，构建分账业务的法律与风控基础。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/auth/bindings",
        "description": "发起付方与收方的关系绑定流程"
      },
      {
        "method": "GET",
        "path": "/api/v1/auth/bindings/{bindingId}",
        "description": "查询绑定关系的详细状态"
      },
      {
        "method": "POST",
        "path": "/api/v1/auth/callback/esign",
        "description": "接收电子签约平台的签约/认证结果回调"
      },
      {
        "method": "POST",
        "path": "/api/v1/auth/payment-enable",
        "description": "为总部商户开通批量付款与会员结算权限"
      }
    ],
    "database_tables": [
      {
        "name": "auth_binding",
        "description": "关系绑定主表，记录付方与收方的授权关系及状态"
      },
      {
        "name": "payment_enable",
        "description": "付款开通表，记录总部开通批量付款/会员结算权限的状态"
      },
      {
        "name": "auth_evidence",
        "description": "认证证据链表，留存协议、认证记录等法律证据"
      }
    ],
    "dependencies": [
      "三代系统",
      "电子签约平台",
      "行业钱包系统"
    ],
    "key_features": [
      "关系绑定与状态机管理",
      "电子协议签署与身份认证集成",
      "付款权限开通管理",
      "全流程证据链留存"
    ]
  },
  {
    "module_name": "三代系统",
    "purpose": "作为“天财商龙”分账业务的核心入口和流程编排中枢，管理商户进件、关系绑定、分账指令发起等全流程业务。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/tiancai/merchants/onboarding",
        "description": "天财业务商户进件"
      },
      {
        "method": "POST",
        "path": "/api/v1/tiancai/bindings",
        "description": "发起关系绑定（签约与认证）"
      },
      {
        "method": "POST",
        "path": "/api/v1/tiancai/split-orders/collection",
        "description": "发起资金归集"
      },
      {
        "method": "POST",
        "path": "/api/v1/tiancai/split-orders/batch-payment",
        "description": "发起批量付款"
      },
      {
        "method": "POST",
        "path": "/api/v1/tiancai/split-orders/member-settlement",
        "description": "发起会员结算"
      },
      {
        "method": "POST",
        "path": "/api/v1/tiancai/merchants/{merchantNo}/enable-payment",
        "description": "为总部商户发起“开通付款”流程"
      }
    ],
    "database_tables": [
      {
        "name": "tiancai_merchant_config",
        "description": "天财商户配置表，存储商户类型、结算模式、状态等信息"
      },
      {
        "name": "tiancai_account",
        "description": "天财账户关联表，关联商户与底层账户及钱包账户"
      },
      {
        "name": "binding_relationship",
        "description": "绑定关系表，存储付方与收方在各种业务场景下的授权关系"
      },
      {
        "name": "split_order",
        "description": "分账指令表，记录归集、付款、结算等分账指令"
      }
    ],
    "dependencies": [
      "行业钱包系统",
      "电子签约平台",
      "账户系统",
      "清结算系统",
      "对账单系统"
    ],
    "key_features": [
      "商户进件与账户配置",
      "关系绑定流程编排",
      "分账业务发起与状态管理",
      "开通付款授权"
    ]
  },
  {
    "module_name": "账务核心系统",
    "purpose": "作为“天财商龙”分账业务的核心处理引擎，负责处理归集、批量付款、会员结算等分账流程的核心业务逻辑与资金划转。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/split/execute",
        "description": "执行单笔分账"
      },
      {
        "method": "POST",
        "path": "/api/v1/split/batch-execute",
        "description": "执行批量分账"
      },
      {
        "method": "POST",
        "path": "/api/v1/split/{splitOrderNo}/reverse",
        "description": "分账冲正"
      },
      {
        "method": "GET",
        "path": "/api/v1/split/orders/{splitOrderNo}",
        "description": "查询分账订单详情"
      },
      {
        "method": "POST",
        "path": "/api/v1/split/validate-relationship",
        "description": "校验分账关系"
      },
      {
        "method": "GET",
        "path": "/api/v1/split/fee-calculate",
        "description": "试算手续费"
      }
    ],
    "database_tables": [
      {
        "name": "split_order",
        "description": "分账订单主表，记录核心交易信息"
      },
      {
        "name": "split_order_item",
        "description": "分账订单明细表，用于批量付款场景"
      },
      {
        "name": "split_relationship_cache",
        "description": "分账关系缓存表，存储付方与收方的绑定及授权状态"
      },
      {
        "name": "split_account_trans_rel",
        "description": "分账与底层账户流水关联表"
      }
    ],
    "dependencies": [
      "行业钱包系统",
      "账户系统",
      "计费中台",
      "清结算系统",
      "业务核心",
      "对账单系统"
    ],
    "key_features": [
      "分账交易处理与状态机管理",
      "手续费计算与扣收",
      "关系绑定与业务规则校验",
      "异常处理与冲正机制",
      "事件驱动与数据同步"
    ]
  },
  {
    "module_name": "行业钱包系统",
    "purpose": "作为“天财商龙”分账业务的核心资金处理与业务逻辑中枢，负责管理钱包账户、校验分账关系、执行分账指令并驱动底层账户完成资金划转。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/wallet/accounts",
        "description": "创建天财专用钱包账户"
      },
      {
        "method": "GET",
        "path": "/api/v1/wallet/accounts/{walletAccountId}",
        "description": "查询钱包账户详情"
      },
      {
        "method": "POST",
        "path": "/api/v1/wallet/bindings/validate",
        "description": "校验绑定关系有效性（分账前置调用）"
      },
      {
        "method": "POST",
        "path": "/api/v1/wallet/transfer",
        "description": "执行分账（资金划转）"
      },
      {
        "method": "GET",
        "path": "/api/v1/wallet/transfer-orders/{walletOrderNo}",
        "description": "查询分账指令状态"
      },
      {
        "method": "POST",
        "path": "/internal/api/v1/wallet/callback/account-transfer",
        "description": "账户系统转账结果回调接口"
      }
    ],
    "database_tables": [
      {
        "name": "wallet_account",
        "description": "钱包账户表，存储钱包层级的账户信息，与底层账户映射"
      },
      {
        "name": "wallet_binding_cache",
        "description": "绑定关系缓存表，存储用于分账校验的付方与收方关系"
      },
      {
        "name": "wallet_transfer_order",
        "description": "钱包分账指令表，记录分账指令的完整状态流转"
      },
      {
        "name": "split_trade_sync_record",
        "description": "分账交易同步记录表，记录向业务核心同步数据的进度与状态"
      }
    ],
    "dependencies": [
      "三代系统",
      "账户系统",
      "业务核心",
      "消息队列(MQ)"
    ],
    "key_features": [
      "钱包账户管理：为商户开立并管理钱包账户，与底层账户系统关联",
      "分账指令处理：执行复杂的业务校验、状态流转，并调用账户系统完成资金划转",
      "绑定关系校验：在分账前对支付关系进行最终的业务逻辑校验",
      "数据同步与状态机：将交易数据同步至业务核心，并维护分账指令的完整状态流转"
    ]
  },
  {
    "module_name": "清结算系统",
    "purpose": "支付平台的资金处理中枢，负责为“天财商龙”业务场景提供交易资金的清算、结算、计费以及退货资金处理服务。",
    "interfaces": [
      {
        "method": "PUT",
        "path": "/internal/api/v1/settlement/config",
        "description": "更新商户结算配置（由三代系统调用）"
      },
      {
        "method": "GET",
        "path": "/internal/api/v1/settlement/config/{merchantNo}",
        "description": "查询商户结算配置"
      },
      {
        "method": "POST",
        "path": "/internal/api/v1/settlement/execute",
        "description": "执行指定批次或商户的结算（可由定时任务或手动触发）"
      },
      {
        "method": "POST",
        "path": "/internal/api/v1/refund/process",
        "description": "处理从天财收款账户发起的退货（由业务核心或退货网关调用）"
      },
      {
        "method": "POST",
        "path": "/internal/api/v1/fee/calculate",
        "description": "计算并扣划分账交易手续费（由行业钱包系统在分账成功后异步调用）"
      }
    ],
    "database_tables": [
      {
        "name": "settlement_config",
        "description": "商户结算配置表，存储商户的结算模式与结算账户配置"
      },
      {
        "name": "settlement_task",
        "description": "结算任务表，记录每个结算批次下每个商户的结算任务执行情况"
      },
      {
        "name": "settlement_detail",
        "description": "结算动账明细表，记录每笔交易结算的详细资金变动"
      },
      {
        "name": "refund_order",
        "description": "退货订单表，记录从天财收款账户发起的退货处理状态"
      },
      {
        "name": "fee_order",
        "description": "手续费订单表，记录分账交易的手续费计算与扣划情况"
      }
    ],
    "dependencies": [
      "三代系统",
      "账户系统",
      "行业钱包系统",
      "业务核心",
      "计费中台",
      "对账单系统"
    ],
    "key_features": [
      "资金结算（主动/被动）",
      "退货资金处理",
      "分账手续费计算与扣划",
      "为对账提供动账明细数据"
    ]
  },
  {
    "module_name": "计费中台",
    "purpose": "负责精确计算分账交易（归集、批量付款、会员结算）产生的手续费，并提供灵活的计费策略管理能力。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/fee/calculate-and-charge",
        "description": "计算并执行手续费扣划（主要入口）"
      },
      {
        "method": "GET",
        "path": "/api/v1/fee/orders/{feeOrderNo}",
        "description": "查询计费指令状态"
      },
      {
        "method": "POST",
        "path": "/internal/api/v1/fee/sync/config",
        "description": "接收从三代系统同步的费率配置"
      },
      {
        "method": "POST",
        "path": "/internal/api/v1/fee/callback/charge-result",
        "description": "清结算系统回调手续费扣划结果"
      }
    ],
    "database_tables": [
      {
        "name": "fee_config",
        "description": "费率配置表，存储商户/业务维度的分账手续费费率规则"
      },
      {
        "name": "fee_order",
        "description": "计费指令表，记录每笔计费请求的详细信息与状态"
      },
      {
        "name": "fee_charge_detail",
        "description": "手续费扣费明细表，记录每笔手续费的实际扣款详情"
      },
      {
        "name": "fee_reconciliation",
        "description": "计费对账表，用于生成每日计费对账文件"
      }
    ],
    "dependencies": [
      "三代系统",
      "行业钱包系统",
      "清结算系统",
      "账户系统",
      "对账单系统"
    ],
    "key_features": [
      "费率配置管理",
      "实时计费计算",
      "计费指令生成与执行",
      "计费规则引擎",
      "计费对账与查询"
    ]
  },
  {
    "module_name": "钱包APP/商服平台",
    "purpose": "作为三代系统与底层账户系统的核心桥梁，负责处理天财专用账户的开户、分账指令执行与资金划转等钱包层核心业务逻辑。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/wallet/accounts/create",
        "description": "创建天财专用钱包账户"
      },
      {
        "method": "GET",
        "path": "/api/v1/wallet/accounts/{walletAccountId}",
        "description": "查询钱包账户详情"
      },
      {
        "method": "POST",
        "path": "/api/v1/wallet/transfers/execute",
        "description": "执行分账（转账）"
      },
      {
        "method": "GET",
        "path": "/api/v1/wallet/transfers/{requestId}",
        "description": "查询分账执行状态"
      },
      {
        "method": "POST",
        "path": "/api/v1/wallet/bindings/validate",
        "description": "校验绑定关系有效性"
      },
      {
        "method": "POST",
        "path": "/internal/api/v1/wallet/callback/account-status",
        "description": "接收账户系统回调的账户状态变更"
      }
    ],
    "database_tables": [
      {
        "name": "wallet_account",
        "description": "钱包账户表，存储钱包账户与底层账户的映射关系及状态"
      },
      {
        "name": "wallet_transfer_order",
        "description": "钱包分账指令表，记录分账请求与执行状态"
      },
      {
        "name": "binding_validation_cache",
        "description": "绑定关系校验缓存表，加速分账前的绑定关系校验"
      },
      {
        "name": "wallet_account_balance_log",
        "description": "钱包账户余额变更日志表，记录余额变动流水"
      }
    ],
    "dependencies": [
      "三代系统",
      "账户系统",
      "业务核心",
      "清结算系统"
    ],
    "key_features": [
      "天财专用账户的开户与状态管理",
      "分账指令的执行与资金划转",
      "分账前的绑定关系与余额校验",
      "交易数据同步与异步回调通知"
    ]
  },
  {
    "module_name": "业务核心",
    "purpose": "作为支付系统的核心交易流水记录与对账数据源，负责接收并持久化分账交易数据，为下游提供统一、标准化的交易流水视图。",
    "interfaces": [
      {
        "method": "POST",
        "path": "/api/v1/biz-core/trades/sync-split",
        "description": "供行业钱包系统调用，同步分账交易数据，需保证幂等性。"
      },
      {
        "method": "GET",
        "path": "/api/v1/biz-core/trades",
        "description": "查询分账交易流水，支持多条件筛选和分页，供内部或对账单系统使用。"
      },
      {
        "method": "GET",
        "path": "/api/v1/biz-core/trades/{tradeNo}",
        "description": "根据交易流水号查询单笔交易详情。"
      }
    ],
    "database_tables": [
      {
        "name": "split_trade",
        "description": "分账交易流水表，存储所有标准化的分账交易记录，是核心数据表。"
      },
      {
        "name": "sync_request_log",
        "description": "同步请求日志表，记录来自行业钱包系统的同步请求，用于实现接口幂等性。"
      }
    ],
    "dependencies": [
      "行业钱包系统",
      "对账单系统",
      "账户系统",
      "三代系统",
      "计费中台/清结算系统"
    ],
    "key_features": [
      "分账交易数据接收与标准化存储",
      "为对账单系统提供核心数据源",
      "通过幂等性设计保证数据一致性",
      "发布交易流水已记录事件驱动下游"
    ]
  },
  {
    "module_name": "对账单系统",
    "purpose": "为“天财商龙”分账业务提供统一的对账数据聚合与账单生成服务。",
    "interfaces": [
      {
        "method": "GET",
        "path": "/api/v1/statement/split-orders",
        "description": "查询‘天财分账’指令账单"
      },
      {
        "method": "GET",
        "path": "/api/v1/statement/account-transactions",
        "description": "查询机构动账明细"
      },
      {
        "method": "GET",
        "path": "/api/v1/statement/split-orders/{bizOrderNo}/detail",
        "description": "查询指定分账指令的完整明细"
      },
      {
        "method": "POST",
        "path": "/api/v1/statement/files/generate",
        "description": "触发生成指定日期的对账文件"
      },
      {
        "method": "GET",
        "path": "/api/v1/statement/files",
        "description": "查询已生成的对账文件列表"
      },
      {
        "method": "GET",
        "path": "/api/v1/statement/files/{fileId}/download",
        "description": "下载对账文件"
      }
    ],
    "database_tables": [
      {
        "name": "split_order_statement",
        "description": "分账指令账单表，存储以分账指令为核心的业务对账数据"
      },
      {
        "name": "account_transaction_statement",
        "description": "机构动账明细表，存储按商户维度的资金流水明细"
      },
      {
        "name": "statement_file",
        "description": "对账文件表，记录已生成的对账文件信息"
      },
      {
        "name": "data_sync_log",
        "description": "数据同步日志表，记录数据同步任务的状态"
      }
    ],
    "dependencies": [
      "业务核心",
      "账户系统",
      "清结算系统",
      "三代系统"
    ],
    "key_features": [
      "多源数据汇聚与关联清洗",
      "生成天财分账指令账单与机构动账明细",
      "提供账单查询、明细查看与文件导出",
      "按周期生成对账文件"
    ]
  }
]